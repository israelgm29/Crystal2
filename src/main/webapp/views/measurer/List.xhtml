<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:composition template="/template.xhtml">
        <ui:define name="title">
            <h:outputText value="#{bundle.ListMeasurerTitle}"></h:outputText>
        </ui:define>
        <ui:define name="body">
            <h:form >
                <h:panelGroup id="messagePanel" layout="block">
                    <h:messages errorStyle="color: red" infoStyle="color: green" layout="table"/>
                </h:panelGroup>
                <h:outputText escape="false" value="#{bundle.ListMeasurerEmpty}" rendered="#{measurerController.items.rowCount == 0}"/>
                <div class="row">
                    <div class="col-12 col-md-6">
                        <div class="card rounded-3">
                            <h6 class="card-header bg-danger text-light">Lista de Medidores de Agua Potable</h6>
                            <div class="card-body ">
                                <h:panelGroup >
                                    <table id="example" class="table table-striped display responsive nowrap" style="width:100%">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Cod Medidor</th>
                                                <th>Fecha Instalación</th>
                                                <th>Tipo de Servicio</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <ui:repeat value="#{measurerController.all()}" var="item">
                                                <tr>
                                                    <td><h:outputText value="#{item.id}"/></td>
                                                    <td><h:outputText value="#{item.number}"/></td>
                                                    <td><h:outputText value="#{item.installationdate}">
                                                            <f:convertDateTime pattern="MM/dd/yyyy" />
                                                        </h:outputText></td>
                                                    <td><h:outputText value="#{item.sapid.name}"/></td>
                                                    <td><h:outputText value="#{item.statusid.name}"/></td>
                                                    <td> <h:commandLink action="#{measurerController.prepareView}">
                                                            <span class=" uk-margin-small-right uk-text-primary fa fa-eye" uk-tooltip="Ver"></span>
                                                        </h:commandLink>
                                                        <h:outputText value=" "/>
                                                        <h:commandLink action="#{measurerController.prepareEdit}">
                                                            <span class=" uk-margin-small-right uk-text-emphasis far fa-edit" uk-tooltip="Editar"></span>
                                                        </h:commandLink>
                                                        <h:outputText value=" "/>
                                                        <h:commandLink action="#{measurerController.destroy}">
                                                            <span class=" uk-margin-small-right uk-text-danger fas fa-trash" uk-tooltip="Borrar" ></span>
                                                        </h:commandLink>
                                                    </td>
                                                </tr>
                                            </ui:repeat>
                                        </tbody>
                                    </table>
                                </h:panelGroup>
                            </div>
                            <h:commandButton class=" btn btn-danger" action="#{measurerController.prepareCreate}" value="#{bundle.ListMeasurerCreateLink}"/>
                          
                        </div>
                    </div> 
                    <div class="col-12 col-md-6">
                        <div class="card rounded-3 ">
                            <h6 class="card-header bg-danger text-light">Estado de Medidores</h6>
                            <div class="card-body ">
                                <canvas id="myChart"   ></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </h:form>

            <script>

                let myCanvas = document.getElementById("myChart").getContext("2d");
                var myChart = new Chart(myCanvas, {
                    type: "bar",
                    data: {
                        labels: ["Activo ", "Suspendido", "Dañado", "Sin Servicio"],
                        datasets: [
                            {
                                backgroundColor: ['rgba(255, 64, 105)',
                                    'rgba(34, 207, 207)', 'rgba(34, 34, 207)', 'rgba(255, 194, 52)'
                                ],
                                data: [5, 2, 1, 3]
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            title: {
                                display: true,
                                text: 'Estado de Medidores '
                            }
                        }
                    }
                }
                );
            </script>
        </ui:define>
    </ui:composition>

</html>